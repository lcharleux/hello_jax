{"version":2,"kind":"Notebook","sha256":"942a4bc6477b558c822ca7ca472a105275ee30b515c21cbdcfe650a12b36f216","slug":"ode-with-jax","location":"/01_ode_with_jax.ipynb","dependencies":[],"frontmatter":{"title":"Des ODE avec Jax ?","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"science","language":"python"},"github":"https://github.com/lcharleux/hello_jax","source_url":"https://github.com/lcharleux/hello_jax/blob/main/book/01_ode_with_jax.ipynb","edit_url":"https://github.com/lcharleux/hello_jax/edit/main/book/01_ode_with_jax.ipynb","exports":[{"format":"ipynb","filename":"01_ode_with_jax.ipynb","url":"/hello_jax/build/01_ode_with_jax-649888281a0e984df378a3fec3c3def6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib ipympl\nimport numpy as np\nimport jax\nimport jax.numpy as jnp\nimport matplotlib.pyplot as plt\nfrom jax import jit, vmap\nfrom dataclasses import dataclass\nfrom jax.tree_util import register_dataclass\nfrom diffrax import ODETerm, Dopri5, SaveAt, PIDController, diffeqsolve\n\njax.config.update(\"jax_enable_x64\", True)","key":"kztcTGcmDt"},{"type":"output","id":"PDmaJwouvwWq6aBK7pG1p","data":[],"key":"zm76jYMJTa"}],"key":"Dt0awFJ8qX"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"mo-python"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Problème","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"caxJ6i8UFK"}],"identifier":"probl-me","label":"Problème","html_id":"probl-me","implicit":true,"key":"goqUOSRhXo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On s’intéresse à une paire d’oscillateurs linéaires couplés par une raideur ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tFLxyQp0g4"},{"type":"inlineMath","value":"K_{12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mn>12</mn></msub></mrow><annotation encoding=\"application/x-tex\">K_{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FM1i7gN2Vm"},{"type":"text","value":".\nOn voudrait trouver un régime permanent de manière simple, par exemple en simulant quelques périodes d’excitation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uxrp9nAC9w"}],"key":"pE3JchyTJD"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"L’équation différentielle est:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PMkQeTnvpA"}],"key":"f8fPkhwwhs"},{"type":"math","value":"\\left \\lbrace \n\\begin{split}\nM_1  \\ddot x_1 + D_1  \\dot x_1 + K_1  x_1 + K_{12} (x_1 - x_2) = F_{d1} \\sin (w_d t)  \\\\\nM_2  \\ddot x_2 + D_2  \\dot x_2 + K_2  x_1 + K_{12} (x_2 - x_1) = F_{d2} \\sin (w_d t) \n\\end{split}\n\\right .","position":{"start":{"line":8,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mi>M</mi><mn>1</mn></msub><msub><mover accent=\"true\"><mi>x</mi><mo>¨</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub><msub><mover accent=\"true\"><mi>x</mi><mo>˙</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>12</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>d</mi><mn>1</mn></mrow></msub><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>d</mi></msub><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mi>M</mi><mn>2</mn></msub><msub><mover accent=\"true\"><mi>x</mi><mo>¨</mo></mover><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><msub><mover accent=\"true\"><mi>x</mi><mo>˙</mo></mover><mn>2</mn></msub><mo>+</mo><msub><mi>K</mi><mn>2</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>12</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>d</mi><mn>2</mn></mrow></msub><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>d</mi></msub><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\left \\lbrace \n\\begin{split}\nM_1  \\ddot x_1 + D_1  \\dot x_1 + K_1  x_1 + K_{12} (x_1 - x_2) = F_{d1} \\sin (w_d t)  \\\\\nM_2  \\ddot x_2 + D_2  \\dot x_2 + K_2  x_1 + K_{12} (x_2 - x_1) = F_{d2} \\sin (w_d t) \n\\end{split}\n\\right .</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">¨</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">¨</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"SRaEyurgmL"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Et d’un point de vue physique, on voudrait connaitre les énergies dissipées par les amortissements ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"fkMRHfJMBR"},{"type":"inlineMath","value":"D_1","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">D_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"USwaSrdcky"},{"type":"text","value":" et ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"iI0FRWZ3Vn"},{"type":"inlineMath","value":"D_2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">D_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VL7pM3cFpe"},{"type":"text","value":" en régime permanent.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tqv4UwhwC6"}],"key":"YcPEBdGscd"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"WYBiXXxLsy"}],"key":"WnC6OawzTd"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Il est possible de simplifier grandement cette équation en l’adimensionnant mais on fait le choix de ne pas le faire ici.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"L0PmbEbl8m"}],"key":"Lojatdt8eI"}],"key":"jr70PjvEOd"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"On la traduit comme suit en Python:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"WgpsYRX24u"}],"key":"aEDkIFGNR8"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On crée une classe pour stocker les paramètres du problème. C’est une solution assez pratique pour éviter de passer trop d’arguments à l’ODE et on peut gérer ça de manière transparente avec Jax.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"YWrKYzVT4O"}],"key":"emYv1DtqyE"}],"key":"B1gbdnCt23"}],"key":"bgsUFMAiBx"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"pyiMFJegPW"}],"key":"AiTJw0Gbvj"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Les paramètres par défaut sont pris au pif, c’est une mauvaise idée. Si vous avez mieux, dites le moi !","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"vsPgwqBIGq"}],"key":"fNInfkfjws"}],"key":"btfptq1cOx"}],"key":"rY18wmkQgr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@register_dataclass\n@dataclass\nclass CoupleLinearResonatorParams:\n    \"\"\"\n    Parameters for the coupled linear resonator ODE system.\n    \"\"\"\n\n    M1: float = 1.0  # Mass 1\n    M2: float = 1.0  # Mass 2\n    K1: float = 1.0  # Spring constant 1\n    K2: float = 1.0  # Spring constant 2\n    K12: float = 0.1  # Coupling spring constant 2\n    D1: float = 0.01  # Damping coefficient 1\n    D2: float = 0.01  # Damping coefficient 2\n    wd: float = 2.0 * jnp.pi  # Driving frequency\n    Fd1: float = 0.5  # Driving force amplitude 1\n    Fd2: float = 0.5  # Driving force amplitude 2\n\n\node_params = CoupleLinearResonatorParams(Fd2=0.0)\node_params","key":"OwUbE9haB5"},{"type":"output","id":"W1ix5Vl0TeeBzul8ypVR0","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"CoupleLinearResonatorParams(M1=1.0, M2=1.0, K1=1.0, K2=1.0, K12=0.1, D1=0.01, D2=0.01, wd=6.283185307179586, Fd1=0.5, Fd2=0.0)","content_type":"text/plain"}}}],"key":"MDjt1atVQV"}],"key":"p6kKSoqa01"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On écrit l’ODE:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E0eCZx8eLC"}],"key":"UATCIPGrnQ"}],"key":"AYRBdaLT7f"}],"key":"vXpY2NPQFx"}],"key":"LnhXZv6obq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def coupled_linear_resonator_ode(t, X, params: CoupleLinearResonatorParams):\n    x1, v1, x2, v2, E1, E2 = X\n    dx1dt = v1\n    dv1dt = (\n        -params.K1 * x1\n        - params.K12 * (x1 - x2)\n        - params.D1 * v1\n        + params.Fd1 * jnp.sin(params.wd * t)\n    ) / params.M1\n    dx2dt = v2\n    dv2dt = (\n        -params.K2 * x2\n        - params.K12 * (x2 - x1)\n        - params.D2 * v2\n        + params.Fd2 * jnp.sin(params.wd * t)\n    ) / params.M2\n    P1 = v1**2 * params.D1\n    P2 = v2**2 * params.D2\n    return jnp.array([dx1dt, dv1dt, dx2dt, dv2dt, P1, P2])\n\n\nX0 = jnp.array(\n    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n)  # Initial state: [x1, v1, x2, v2, E1, E2]\nt = 0.2  # Initial time\ncoupled_linear_resonator_ode(t, X0, ode_params)","key":"JLY2mJTiaB"},{"type":"output","id":"rpBtQFhncDxDt3j4MrP_2","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"Array([0.        , 0.47552826, 0.        , 0.        , 0.        ,\n       0.        ], dtype=float64)","content_type":"text/plain"}}}],"key":"thbVQ2yujo"}],"key":"K44znFOfFf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ok, notre ODE fonctionne.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uMKL6JPjvu"}],"key":"tRdrUnit5h"},{"type":"list","ordered":true,"start":3,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Essayons de l’intégrer:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YvPPTtCjND"}],"key":"UsplepXCuh"}],"key":"Lpp3Mb6qVR"}],"key":"pGw8e8eqcL"}],"key":"TdBKTaKmT2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"term = ODETerm(coupled_linear_resonator_ode)  # Define the ODE term\nsolver = Dopri5()  # Choose the Dormand-Prince 5(4) solver\nt0 = 0.0  # Initial time\nt1 = 10.0  # Final time\n\nsaveat = SaveAt(ts=[t0, t1])  # Specify time points to save the solution\nstepsize_controller = PIDController(rtol=1e-5, atol=1e-5)\nsol = diffeqsolve(\n    term,\n    solver,\n    t0=t0,\n    t1=t1,\n    dt0=0.1,\n    y0=X0,\n    saveat=saveat,\n    stepsize_controller=stepsize_controller,\n    args=ode_params,\n)\n\nprint(sol.ts)  # DeviceArray([0.   , 1.   , 2.   , 3.    ])\nprint(sol.ys)  # DeviceArray([1.   , 0.368, 0.135, 0.0498])","key":"DbI0t2n8G1"},{"type":"output","id":"dIvf4EIbMrJ7mFpvkfdKu","data":[{"output_type":"stream","name":"stdout","text":"[ 0. 10.]\n[[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [-5.67547499e-02 -1.15747367e-01  1.44728775e-02 -3.08412707e-02\n   6.36279887e-04  2.00425452e-05]]\n"}],"key":"PN4AuZTDfi"}],"key":"oBNdv4kwlp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ok cela fonctionne, on peut donc construire une fonction qui fait la tâche demandée:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XaY1absnUt"}],"key":"fALAkYqL6D"}],"key":"Arlmqtdbht"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@register_dataclass\n@dataclass\nclass CalculateSteadyStatePowerParams:\n    t0: float = 0.0\n    t1: float = 5.0\n    max_steps: int = 100000\n\n\ndef calculate_steady_state_power(\n    X0,\n    ode_params: CoupleLinearResonatorParams,\n    calc_params: CalculateSteadyStatePowerParams,\n):\n    \"\"\"\n    Calculate the steady-state power dissipated by each resonator.\n\n        A tuple containing the steady-state power dissipated by resonator 1 and resonator\n    \"\"\"\n    term = ODETerm(coupled_linear_resonator_ode)  # Define the ODE term\n    solver = Dopri5()  # Choose the Dormand-Prince 5(4) solver\n    t0 = calc_params.t0  # Initial time\n    t1 = calc_params.t1  # Final time\n    Td = 2 * jnp.pi / ode_params.wd  # Driving period\n    t2 = t1 + Td\n\n    saveat0 = SaveAt(ts=[t0, t1])  # Specify time points to save the solution\n    stepsize_controller = PIDController(rtol=1e-5, atol=1e-5)\n    sol0 = diffeqsolve(\n        term,\n        solver,\n        t0=t0,\n        t1=t1,\n        dt0=0.1,\n        y0=X0,\n        saveat=saveat0,\n        stepsize_controller=stepsize_controller,\n        max_steps=calc_params.max_steps,\n        args=ode_params,\n    )\n    X1 = sol0.ys[-1]  # State at time t1\n    X1 = X1.at[4:].set(0.0)  # Reset accumulated power to zero\n    saveat1 = SaveAt(ts=[t1, t2])  # Specify time points to save the solution\n    sol1 = diffeqsolve(\n        term,\n        solver,\n        t0=t1,\n        t1=t2,\n        dt0=0.1,\n        y0=X1,\n        saveat=saveat1,\n        stepsize_controller=stepsize_controller,\n        max_steps=calc_params.max_steps,\n        args=ode_params,\n    )\n    X2 = sol1.ys[-1]  # State at time t2\n    P = (X2[4:]) / Td  # Average power dissipated over one period\n    return P\n\n\nP = calculate_steady_state_power(\n    X0, ode_params, CalculateSteadyStatePowerParams(t0=0.0, t1=100.0)\n)\nP","key":"Nhl431ia8E"},{"type":"output","id":"umnwJ6Aue4d1XJiZ1A5pO","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Array([3.32445654e-05, 2.21748694e-05], dtype=float64)","content_type":"text/plain"}}}],"key":"BPNtaDE7E6"}],"key":"VT8FE0BYCw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"On peut donc calculer les puissances en régime établi pour les 2 oscillateurs.\nFaisons maintenant une étude paramétrique avec ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DCIVnaeF1H"},{"type":"inlineCode","value":"vmap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FphEiDmZ6W"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v99DxgNqOt"}],"key":"QaxxLvJlyg"}],"key":"XfFDqHk5S6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"K1v = jnp.linspace(0.0, 3.0, 100)\nK2v = jnp.linspace(0.0, 3.0, 100)\n\nvcalc_steady_state_power = vmap(\n    vmap(\n        calculate_steady_state_power,\n        in_axes=(\n            None,\n            CoupleLinearResonatorParams(\n                M1=None,\n                M2=None,\n                K1=0,\n                K2=None,\n                K12=None,\n                D1=None,\n                D2=None,\n                wd=None,\n                Fd1=None,\n                Fd2=None,\n            ),\n            None,\n        ),\n    ),\n    in_axes=(\n        None,\n        CoupleLinearResonatorParams(\n            M1=None,\n            M2=None,\n            K1=None,\n            K2=0,\n            K12=None,\n            D1=None,\n            D2=None,\n            wd=None,\n            Fd1=None,\n            Fd2=None,\n        ),\n        None,\n    ),\n)\node_params2 = CoupleLinearResonatorParams(\n    Fd2=1.0,\n    Fd1=1.0,\n    K1=K1v,\n    K2=K2v,\n    wd=2.0 * jnp.pi,\n    K12=0,\n    D1=0.1,\n    D2=0.1,\n    M1=4.0 * jnp.pi**2,\n    M2=4.0 * jnp.pi**2,\n)\nP2 = vcalc_steady_state_power(\n    X0, ode_params2, CalculateSteadyStatePowerParams(t0=0.0, t1=200.0)\n)\nP2.shape","key":"XhHZl2j0yF"},{"type":"output","id":"cNrJZGZIrhvvZ0avuzK5d","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"(100, 100, 2)","content_type":"text/plain"}}}],"key":"B5rn4E65cM"}],"key":"osLDhI7MMI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12, 6))\nax0 = fig.add_subplot(121)\nplt.contourf(K1v, K2v, P2[:, :, 0].T * 1.0e3, levels=20, cmap=\"YlOrRd\")\nplt.colorbar(\n    label=\"Steady-State Power Dissipated by Resonator 1 [mW]\", orientation=\"horizontal\"\n)\nplt.contour(K1v, K2v, P2[:, :, 0].T * 1.0e3, levels=20, colors=\"black\", linewidths=0.5)\nplt.xlabel(\"K1\")\nplt.ylabel(\"K2\")\nplt.grid()\nax1 = fig.add_subplot(122)\nplt.contourf(K1v, K2v, P2[:, :, 1].T * 1.0e3, levels=20, cmap=\"YlOrRd\")\nplt.colorbar(\n    label=\"Steady-State Power Dissipated by Resonator 2 [mW]\", orientation=\"horizontal\"\n)\nplt.contour(K1v, K2v, P2[:, :, 1].T * 1.0e3, levels=20, colors=\"black\", linewidths=0.5)\nplt.xlabel(\"K1\")\n# plt.ylabel(\"K2\")\nplt.grid()\nplt.show()","key":"fGsCGct9S6"},{"type":"output","id":"T6UGZn_oi5kggqnacK-DA","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1b621603bcc06c62f9e6528a46bb4f48","path":"/hello_jax/build/1b621603bcc06c62f9e6528a46bb4f48.png"},"text/html":{"content_type":"text/html","hash":"8cef70b26914b03a9a89b0baf9b8a652","path":"/hello_jax/build/8cef70b26914b03a9a89b0baf9b8a652.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"304e86d8fa7543aeae893b1caad4e58e\"}","content_type":"application/vnd.jupyter.widget-view+json"}}}],"key":"KAODoPyJwz"}],"key":"Kls3h56DpK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"C’est beau mais assez étrange. A discuter !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7KFr4uLnK"}],"key":"RbkrcVJkSs"}],"key":"EIJImUSBdC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\nplt.plot(K1v, P2[0, :, 0] * 1.0e3)","key":"WQ13WnmBlj"},{"type":"output","id":"vDvuITlzoHtBkuCAIq-OH","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"66fb8d672b5fd9ba4914790522aef1c0","path":"/hello_jax/build/66fb8d672b5fd9ba4914790522aef1c0.png"},"text/html":{"content_type":"text/html","hash":"919d4f4f11990e1990343bddb5839d42","path":"/hello_jax/build/919d4f4f11990e1990343bddb5839d42.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"b600d010c25b43d69210bc8fe809ae5e\"}","content_type":"application/vnd.jupyter.widget-view+json"}}}],"key":"pFYsEoUd1F"}],"key":"NzIfkT0xsw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"epmBQBWvp0"},{"type":"output","id":"-JUzL39UL0EUjlAYfZzeL","data":[],"key":"k2RmSvmCKm"}],"key":"oY2GPByJi1"}],"key":"YtNHpkEGK4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"JAX pour Cloé","url":"/","group":"JAX pour Cloé"}}},"domain":"http://localhost:3004"}