<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Des ODE avec Jax ? - JAX pour Cloé</title><meta property="og:title" content="Des ODE avec Jax ? - JAX pour Cloé"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.webp"/><meta property="og:image" content="lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.webp"/><link rel="stylesheet" href="lcharleux.github.io/hello_jax//build/_assets/app-KKSZXL3E.css"/><link rel="stylesheet" href="lcharleux.github.io/hello_jax//build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="lcharleux.github.io/hello_jax//favicon.ico"/><link rel="stylesheet" href="lcharleux.github.io/hello_jax//myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/lcharleux.github.io/hello_jax//"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="JAX pour Cloé" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/lcharleux.github.io/hello_jax//">JAX pour Cloé</a><a title="Des ODE avec Jax ?" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/lcharleux.github.io/hello_jax//ode-with-jax">Des ODE avec Jax ?</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/lcharleux/hello_jax" title="GitHub Repository: lcharleux/hello_jax" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/lcharleux/hello_jax/edit/publish/book/01_ode_with_jax.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Des ODE avec Jax ?</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="ZYfh2ULXWM" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%matplotlib ipympl
import numpy as np
import jax
import jax.numpy as jnp
import matplotlib.pyplot as plt
from jax import jit, vmap
from dataclasses import dataclass
from diffrax import ODETerm, Dopri5, SaveAt, PIDController, diffeqsolve</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Glf0Jg4sEX9-MlP6Iht5o" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Wa9AoDuwDO" class="myst-jp-nb-block relative group/block"><h2 id="probl-me" class="relative group"><span class="heading-text">Problème</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#probl-me" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>On veut intégrer l’ODE suivante:</p><div id="hxHzTcGymd" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>M</mi><mn>1</mn></msub><msub><mover accent="true"><mi>x</mi><mo>¨</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub><msub><mover accent="true"><mi>x</mi><mo>˙</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>12</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>d</mi><mn>1</mn></mrow></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mi>d</mi></msub><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>M</mi><mn>2</mn></msub><msub><mover accent="true"><mi>x</mi><mo>¨</mo></mover><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><msub><mover accent="true"><mi>x</mi><mo>˙</mo></mover><mn>2</mn></msub><mo>+</mo><msub><mi>K</mi><mn>2</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>12</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>d</mi><mn>2</mn></mrow></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mi>d</mi></msub><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\left \lbrace 
\begin{split}
M_1  \ddot x_1 + D_1  \dot x_1 + K_1  x_1 + K_{12} (x_1 - x_2) = F_{d1} \sin (w_d t)  \\
M_2  \ddot x_2 + D_2  \dot x_2 + K_2  x_1 + K_{12} (x_2 - x_1) = F_{d2} \sin (w_d t) 
\end{split}
\right .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">¨</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">¨</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#hxHzTcGymd" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>Il est possible de simplifier grandement cette équation en l’adimensionnant mais on fait le choix de ne pas le faire ici.</p></div></aside><p>On la traduit comme suit en Python:</p><ol start="1"><li><p>On crée une classe pour stocker les paramètres du problème:</p></li></ol></div><div id="vkSbY6Cbef" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">@dataclass
class CoupleLinearResonatorParams:
    &quot;&quot;&quot;
    Parameters for the coupled linear resonator ODE system.
    &quot;&quot;&quot;

    M1: float = 1.0  # Mass 1
    M2: float = 1.0  # Mass 2
    K1: float = 1.0  # Spring constant 1
    K2: float = 1.0  # Spring constant 2
    K12: float = 0.5  # Coupling spring constant 2
    D1: float = 0.2  # Damping coefficient 1
    D2: float = 0.2  # Damping coefficient 2
    wd: float = 0.5  # Driving frequency
    Fd1: float = 0.5  # Driving force amplitude 1
    Fd2: float = 0.5  # Driving force amplitude 2


ode_params = CoupleLinearResonatorParams(Fd2 = 0.)
ode_params</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wAB7vO2TVhdRMMu0e9x6A" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="myst-jp-safe-output-text font-mono text-sm whitespace-pre-wrap"><code><span>CoupleLinearResonatorParams(M1=1.0, M2=1.0, K1=1.0, K2=1.0, K12=0.5, D1=0.2, D2=0.2, wd=0.5, Fd1=0.5, Fd2=0.0)</span></code></div></div></div><div id="puDiK1p7bu" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def coupled_linear_resonator_ode(t, X, params: CoupleLinearResonatorParams):
    x1, v1, x2, v2 = X
    dx1dt = v1
    dv1dt = (
        -params.K1 * x1
        - params.K12 * (x1 - x2)
        - params.D1 * v1
        + params.Fd1 * jnp.sin(params.wd * t)
    ) / params.M1
    dx2dt = v2
    dv2dt = (
        -params.K2 * x2
        - params.K12 * (x2 - x1)
        - params.D2 * v2
        + params.Fd2 * jnp.sin(params.wd * t)
    ) / params.M2
    return jnp.array([dx1dt, dv1dt, dx2dt, dv2dt])


ode = coupled_linear_resonator_ode
X = jnp.array([0.0, 0.0, 0.0, 0.0])  # Initial state: [x1, v1, x2, v2]
t = 0.2  # Initial time
ode(t,X,ode_params)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_uEuiZl3S8b8rcbGaSmst" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="myst-jp-safe-output-text font-mono text-sm whitespace-pre-wrap"><code><span>Array([0.        , 0.04991671, 0.        , 0.        ], dtype=float32)</span></code></div></div></div><div id="gocHFQiRwJ" class="myst-jp-nb-block relative group/block"><p>Ok, ça marche !</p></div><div id="BPGYmASPWg" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">term = ODETerm(ode)
solver = Dopri5()
saveat = SaveAt(ts=[0., 1., 2., 3.])
stepsize_controller = PIDController(rtol=1e-5, atol=1e-5)

sol = diffeqsolve(term, solver, t0=0, t1=3, dt0=0.1, y0=1, saveat=saveat,
                   stepsize_controller=stepsize_controller)

# print(sol.ts)  # DeviceArray([0.   , 1.   , 2.   , 3.    ])
# print(sol.ys)  # DeviceArray([1.   , 0.368, 0.135, 0.0498])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BAwwZS6ObExNklRul39gt" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-error-output text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">TypeError</span><span>                                 Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:170</span><span>, in </span><span style="color:rgb(0, 187, 187)">_assert_term_compatible.&lt;locals&gt;._check</span><span style="color:rgb(0, 0, 187)">(term_cls, term, term_contr_kwargs, yi)</span><span>
</span><span style="color:rgb(0, 187, 0)">    169</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">try</span><span>:
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">170</span><span>     vf_type = </span><span style="background-color:rgb(187, 187, 0)">eqx</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">filter_eval_shape</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">term</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">vf</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">t</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">yi</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    171</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">except</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">Exception</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span> e:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/equinox/_eval_shape.py:38</span><span>, in </span><span style="color:rgb(0, 187, 187)">filter_eval_shape</span><span style="color:rgb(0, 0, 187)">(fun, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">     37</span><span> dynamic, static = partition((fun, args, kwargs), _filter)
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">38</span><span> dynamic_out, static_out = </span><span style="background-color:rgb(187, 187, 0)">jax</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">eval_shape</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">ft</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">partial</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">_fn</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">static</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">dynamic</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">     39</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> combine(dynamic_out, static_out.value)

    </span><span style="color:rgb(187, 0, 0)">[... skipping hidden 1 frame]</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/api.py:3115</span><span>, in </span><span style="color:rgb(0, 187, 187)">eval_shape</span><span style="color:rgb(0, 0, 187)">(fun, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   3114</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">except</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">TypeError</span><span>: fun = partial(fun)
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">3115</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">jit</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">trace</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>.out_info

    </span><span style="color:rgb(187, 0, 0)">[... skipping hidden 1 frame]</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:306</span><span>, in </span><span style="color:rgb(0, 187, 187)">jit_trace</span><span style="color:rgb(0, 0, 187)">(jit_func, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    304</span><span> </span><span style="color:rgb(175, 0, 255)">@api_boundary</span><span>
</span><span style="color:rgb(0, 187, 0)">    305</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">jit_trace</span><span>(jit_func, *args, **kwargs) -&gt; stages.Traced:
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">306</span><span>   p, args_flat = </span><span style="background-color:rgb(187, 187, 0)">_infer_params</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">jit_func</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">_fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">jit_func</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">_jit_info</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    307</span><span>   arg_types = </span><span style="color:rgb(0, 135, 0)">map</span><span>(convert_to_metaty, args_flat)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:630</span><span>, in </span><span style="color:rgb(0, 187, 187)">_infer_params</span><span style="color:rgb(0, 0, 187)">(fun, ji, args, kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    629</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">630</span><span>   </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">_infer_params_internal</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">ji</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:655</span><span>, in </span><span style="color:rgb(0, 187, 187)">_infer_params_internal</span><span style="color:rgb(0, 0, 187)">(fun, ji, args, kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    654</span><span> dbg = dbg_fn()
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">655</span><span> p, args_flat = </span><span style="background-color:rgb(187, 187, 0)">_infer_params_impl</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">    656</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">ji</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">ctx_mesh</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">dbg</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">in_avals</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">avals</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    657</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> p.params[</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">jaxpr</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>].jaxpr.is_high:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:551</span><span>, in </span><span style="color:rgb(0, 187, 187)">_infer_params_impl</span><span style="color:rgb(0, 0, 187)">(***failed resolving arguments***)</span><span>
</span><span style="color:rgb(0, 187, 0)">    549</span><span> qdd_token = _qdd_cache_index(flat_fun, in_type)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">551</span><span> jaxpr, consts, out_avals = </span><span style="background-color:rgb(187, 187, 0)">_create_pjit_jaxpr</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">    552</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">flat_fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">in_type</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">qdd_token</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">IgnoreKey</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">ji</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">inline</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    553</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> config.mutable_array_checks.value:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:496</span><span>, in </span><span style="color:rgb(0, 187, 187)">cache.&lt;locals&gt;.memoized_fun</span><span style="color:rgb(0, 0, 187)">(fun, *args)</span><span>
</span><span style="color:rgb(0, 187, 0)">    495</span><span>   start = time.time()
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">496</span><span> ans = </span><span style="background-color:rgb(187, 187, 0)">call</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    497</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> do_explain:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:1184</span><span>, in </span><span style="color:rgb(0, 187, 187)">_create_pjit_jaxpr</span><span style="color:rgb(0, 0, 187)">(***failed resolving arguments***)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1183</span><span>   </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1184</span><span>     jaxpr, global_out_avals, consts = </span><span style="background-color:rgb(187, 187, 0)">pe</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">trace_to_jaxpr_dynamic</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">in_type</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1186</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> config.debug_key_reuse.value:
</span><span style="color:rgb(0, 187, 0)">   1187</span><span>   </span><span style="color:rgb(95, 135, 135);font-style:italic"># Import here to avoid circular imports</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/profiler.py:359</span><span>, in </span><span style="color:rgb(0, 187, 187)">annotate_function.&lt;locals&gt;.wrapper</span><span style="color:rgb(0, 0, 187)">(*args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    358</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">with</span><span> TraceAnnotation(name, **decorator_kwargs):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">359</span><span>   </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/interpreters/partial_eval.py:2409</span><span>, in </span><span style="color:rgb(0, 187, 187)">trace_to_jaxpr_dynamic</span><span style="color:rgb(0, 0, 187)">(fun, in_avals, keep_inputs, lower, auto_dce)</span><span>
</span><span style="color:rgb(0, 187, 0)">   2408</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">with</span><span> core.set_current_trace(trace):
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">2409</span><span>   ans = </span><span style="background-color:rgb(187, 187, 0)">fun</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">call_wrapped</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">in_tracers</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   2410</span><span> _check_returned_jaxtypes(fun.debug_info, ans)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:212</span><span>, in </span><span style="color:rgb(0, 187, 187)">WrappedFun.call_wrapped</span><span style="color:rgb(0, 0, 187)">(self, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    211</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;Calls the transformed function&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">212</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">f_transformed</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/api_util.py:73</span><span>, in </span><span style="color:rgb(0, 187, 187)">flatten_fun</span><span style="color:rgb(0, 0, 187)">(f, store, in_tree, *args_flat)</span><span>
</span><span style="color:rgb(0, 187, 0)">     72</span><span> py_args, py_kwargs = tree_unflatten(in_tree, args_flat)
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">73</span><span> ans = </span><span style="background-color:rgb(187, 187, 0)">f</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">py_args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">py_kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">     74</span><span> ans, out_tree = tree_flatten(ans)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:421</span><span>, in </span><span style="color:rgb(0, 187, 187)">_get_result_paths_thunk</span><span style="color:rgb(0, 0, 187)">(_fun, _store, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    419</span><span> </span><span style="color:rgb(175, 0, 255)">@transformation_with_aux2</span><span>
</span><span style="color:rgb(0, 187, 0)">    420</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">_get_result_paths_thunk</span><span>(_fun: Callable, _store: Store, *args, **kwargs):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">421</span><span>   ans = </span><span style="background-color:rgb(187, 187, 0)">_fun</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    422</span><span>   result_paths = </span><span style="color:rgb(0, 135, 0)">tuple</span><span>(</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">result</span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>_clean_keystr_arg_names(path)</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">&quot;</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> path, _ </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> generate_key_paths(ans))

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/equinox/_eval_shape.py:33</span><span>, in </span><span style="color:rgb(0, 187, 187)">filter_eval_shape.&lt;locals&gt;._fn</span><span style="color:rgb(0, 0, 187)">(_static, _dynamic)</span><span>
</span><span style="color:rgb(0, 187, 0)">     32</span><span> _fun, _args, _kwargs = combine(_static, _dynamic)
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">33</span><span> _out = </span><span style="background-color:rgb(187, 187, 0)">_fun</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">_args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">_kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">     34</span><span> _dynamic_out, _static_out = partition(_out, _filter)

    </span><span style="color:rgb(187, 0, 0)">[... skipping hidden 1 frame]</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_term.py:194</span><span>, in </span><span style="color:rgb(0, 187, 187)">ODETerm.vf</span><span style="color:rgb(0, 0, 187)">(self, t, y, args)</span><span>
</span><span style="color:rgb(0, 187, 0)">    193</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">vf</span><span>(</span><span style="color:rgb(0, 135, 0)">self</span><span>, t: RealScalarLike, y: Y, args: Args) -&gt; _VF:
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">194</span><span>     out = </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">vector_field</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">t</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">y</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    195</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> jtu.tree_structure(out) != jtu.tree_structure(y):

</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[3]</span><span style="color:rgb(0, 187, 0)">, line 2</span><span>, in </span><span style="color:rgb(0, 187, 187)">coupled_linear_resonator_ode</span><span style="color:rgb(0, 0, 187)">(t, X, params)</span><span>
</span><span style="color:rgb(0, 187, 0)">      1</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">coupled_linear_resonator_ode</span><span>(t, X, params: CoupleLinearResonatorParams):
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">2</span><span>     x1, v1, x2, v2 = X
</span><span style="color:rgb(0, 187, 0)">      3</span><span>     dx1dt = v1

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/core.py:944</span><span>, in </span><span style="color:rgb(0, 187, 187)">Tracer.__iter__</span><span style="color:rgb(0, 0, 187)">(self)</span><span>
</span><span style="color:rgb(0, 187, 0)">    943</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">__iter__</span><span>(</span><span style="color:rgb(0, 135, 0)">self</span><span>):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">944</span><span>   </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="color:rgb(0, 135, 0)">iter</span><span>(</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">aval</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">_iter</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">)</span><span>)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/lax/lax.py:3913</span><span>, in </span><span style="color:rgb(0, 187, 187)">_iter</span><span style="color:rgb(0, 0, 187)">(tracer)</span><span>
</span><span style="color:rgb(0, 187, 0)">   3912</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> tracer.ndim == </span><span style="color:rgb(0, 187, 0)">0</span><span>:
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">3913</span><span>   </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">TypeError</span><span>(</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">iteration over a 0-d array</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>)  </span><span style="color:rgb(95, 135, 135);font-style:italic"># same as numpy error</span><span>
</span><span style="color:rgb(0, 187, 0)">   3914</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:

</span><span style="color:rgb(187, 0, 0)">TypeError</span><span>: iteration over a 0-d array

During handling of the above exception, another exception occurred:

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:200</span><span>, in </span><span style="color:rgb(0, 187, 187)">_assert_term_compatible</span><span style="color:rgb(0, 0, 187)">(t, y, args, terms, term_structure, contr_kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    199</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">with</span><span> jax.numpy_dtype_promotion(</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">standard</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">200</span><span>         </span><span style="background-color:rgb(187, 187, 0)">jtu</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">tree_map</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">_check</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">term_structure</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">terms</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">contr_kwargs</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">y</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    201</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">except</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span> e:
</span><span style="color:rgb(0, 187, 0)">    202</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># ValueError may also arise from mismatched tree structures</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/tree_util.py:361</span><span>, in </span><span style="color:rgb(0, 187, 187)">tree_map</span><span style="color:rgb(0, 0, 187)">(f, tree, is_leaf, *rest)</span><span>
</span><span style="color:rgb(0, 187, 0)">    360</span><span> all_leaves = [leaves] + [treedef.flatten_up_to(r) </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> r </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> rest]
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">361</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">treedef</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">unflatten</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">f</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">xs</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">for</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">xs</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(175, 0, 255);font-weight:bold">in</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">zip</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">all_leaves</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/tree_util.py:361</span><span>, in </span><span style="color:rgb(0, 187, 187)">&lt;genexpr&gt;</span><span style="color:rgb(0, 0, 187)">(.0)</span><span>
</span><span style="color:rgb(0, 187, 0)">    360</span><span> all_leaves = [leaves] + [treedef.flatten_up_to(r) </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> r </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> rest]
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">361</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> treedef.unflatten(</span><span style="background-color:rgb(187, 187, 0)">f</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">xs</span><span style="background-color:rgb(187, 187, 0)">)</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> xs </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> </span><span style="color:rgb(0, 135, 0)">zip</span><span>(*all_leaves))

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:172</span><span>, in </span><span style="color:rgb(0, 187, 187)">_assert_term_compatible.&lt;locals&gt;._check</span><span style="color:rgb(0, 0, 187)">(term_cls, term, term_contr_kwargs, yi)</span><span>
</span><span style="color:rgb(0, 187, 0)">    171</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">except</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">Exception</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span> e:
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">172</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span>(</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">Error while tracing </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>term</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">.vf: </span><span style="color:rgb(187, 187, 0)">&quot;</span><span> + </span><span style="color:rgb(0, 135, 0)">str</span><span>(e))
</span><span style="color:rgb(0, 187, 0)">    173</span><span> vf_type_compatible = eqx.filter_eval_shape(
</span><span style="color:rgb(0, 187, 0)">    174</span><span>     better_isinstance, vf_type, vf_type_expected
</span><span style="color:rgb(0, 187, 0)">    175</span><span> )

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: Error while tracing ODETerm(vector_field=&lt;function coupled_linear_resonator_ode&gt;).vf: iteration over a 0-d array

The above exception was the direct cause of the following exception:

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[8]</span><span style="color:rgb(0, 187, 0)">, line 6</span><span>
</span><span style="color:rgb(0, 187, 0)">      3</span><span> saveat = SaveAt(ts=[</span><span style="color:rgb(0, 187, 0)">0.</span><span>, </span><span style="color:rgb(0, 187, 0)">1.</span><span>, </span><span style="color:rgb(0, 187, 0)">2.</span><span>, </span><span style="color:rgb(0, 187, 0)">3.</span><span>])
</span><span style="color:rgb(0, 187, 0)">      4</span><span> stepsize_controller = PIDController(rtol=</span><span style="color:rgb(0, 187, 0)">1e-5</span><span>, atol=</span><span style="color:rgb(0, 187, 0)">1e-5</span><span>)
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">6</span><span> sol = </span><span style="background-color:rgb(187, 187, 0)">diffeqsolve</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">term</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">solver</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">t0</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">0</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">t1</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">3</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">dt0</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">0.1</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">y0</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">1</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">saveat</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">saveat</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">      7</span><span> </span><span style="background-color:rgb(187, 187, 0)">                   </span><span style="background-color:rgb(187, 187, 0)">stepsize_controller</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">stepsize_controller</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">      9</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># print(sol.ts)  # DeviceArray([0.   , 1.   , 2.   , 3.    ])</span><span>
</span><span style="color:rgb(0, 187, 0)">     10</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># print(sol.ys)  # DeviceArray([1.   , 0.368, 0.135, 0.0498])</span><span>

    </span><span style="color:rgb(187, 0, 0)">[... skipping hidden 18 frame]</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:1103</span><span>, in </span><span style="color:rgb(0, 187, 187)">diffeqsolve</span><span style="color:rgb(0, 0, 187)">(terms, solver, t0, t1, dt0, y0, args, saveat, stepsize_controller, adjoint, event, max_steps, throw, progress_meter, solver_state, controller_state, made_jump, discrete_terminating_event)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1100</span><span>         terms = MultiTerm(*terms)
</span><span style="color:rgb(0, 187, 0)">   1102</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Error checking for term compatibility</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1103</span><span> </span><span style="background-color:rgb(187, 187, 0)">_assert_term_compatible</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">   1104</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">t0</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1105</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">y0</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1106</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1107</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">terms</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1108</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">solver</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">term_structure</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1109</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">solver</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">term_compatible_contr_kwargs</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1110</span><span> </span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1112</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> is_sde(terms):
</span><span style="color:rgb(0, 187, 0)">   1113</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">not</span><span> </span><span style="color:rgb(0, 135, 0)">isinstance</span><span>(solver, (AbstractItoSolver, AbstractStratonovichSolver)):

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:205</span><span>, in </span><span style="color:rgb(0, 187, 187)">_assert_term_compatible</span><span style="color:rgb(0, 0, 187)">(t, y, args, terms, term_structure, contr_kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    203</span><span> pretty_term = wl.pformat(terms)
</span><span style="color:rgb(0, 187, 0)">    204</span><span> pretty_expected = wl.pformat(term_structure)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">205</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span>(
</span><span style="color:rgb(0, 187, 0)">    206</span><span>     </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">Terms are not compatible with solver! Got:</span><span style="color:rgb(175, 95, 0);font-weight:bold">\n</span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>pretty_term</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(175, 95, 0);font-weight:bold">\n</span><span style="color:rgb(187, 187, 0)">but expected:</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    207</span><span>     </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(175, 95, 0);font-weight:bold">\n</span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>pretty_expected</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(175, 95, 0);font-weight:bold">\n</span><span style="color:rgb(187, 187, 0)">Note that terms are checked recursively: if you </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    208</span><span>     </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">scroll up you may find a root-cause error that is more specific.</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    209</span><span> ) </span><span style="color:rgb(0, 135, 0);font-weight:bold">from</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">e</span><span>

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: Terms are not compatible with solver! Got:
ODETerm(vector_field=&lt;function coupled_linear_resonator_ode&gt;)
but expected:
diffrax.AbstractTerm
Note that terms are checked recursively: if you scroll up you may find a root-cause error that is more specific.</span></code></pre></div></div></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/lcharleux.github.io/hello_jax//"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">JAX pour Cloé</div>JAX pour Cloé</div></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let d=Math.random().toString(32).slice(2);window.history.replaceState({key:d},"")}try{let u=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof u=="number"&&window.scrollTo(0,u)}catch(d){console.error(d),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-UGO2RSJF.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-HHKX4TLX.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-YATQFWLS.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-MBMQ6BQC.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-CVDX4WR7.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-NK7RXO5Q.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/root-TRTRBUUN.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-6NUWI4AQ.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/_shared/chunk-M5KN76GI.js"/><link rel="modulepreload" href="lcharleux.github.io/hello_jax//build/routes/$-VLPGWU3Z.js"/><script>window.__remixContext = {"url":"/ode-with-jax","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{},"nav":[],"actions":[],"projects":[{"title":"JAX pour Cloé","github":"https://github.com/lcharleux/hello_jax","id":"8d100ed7-36b2-4354-97ab-43bab996214f","thumbnail":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.gif","thumbnailOptimized":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.webp","exports":[],"bibliography":[],"index":"intro-to-jax","pages":[{"slug":"ode-with-jax","title":"Des ODE avec Jax ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"lcharleux.github.io/hello_jax/"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{},"nav":[],"actions":[],"projects":[{"title":"JAX pour Cloé","github":"https://github.com/lcharleux/hello_jax","id":"8d100ed7-36b2-4354-97ab-43bab996214f","thumbnail":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.gif","thumbnailOptimized":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.webp","exports":[],"bibliography":[],"index":"intro-to-jax","pages":[{"slug":"ode-with-jax","title":"Des ODE avec Jax ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"a0ad4d12a64b08a7958340cfd528cec9f8e7ae1ab4aabc605c4923e58e04f4c0","slug":"ode-with-jax","location":"/01_ode_with_jax.ipynb","dependencies":[],"frontmatter":{"title":"Des ODE avec Jax ?","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"science","language":"python"},"github":"https://github.com/lcharleux/hello_jax","source_url":"https://github.com/lcharleux/hello_jax/blob/publish/book/01_ode_with_jax.ipynb","edit_url":"https://github.com/lcharleux/hello_jax/edit/publish/book/01_ode_with_jax.ipynb","exports":[{"format":"ipynb","filename":"01_ode_with_jax.ipynb","url":"lcharleux.github.io/hello_jax//build/01_ode_with_jax-7f0a59da7cefe0dbf019d3e9b9ac3020.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib ipympl\nimport numpy as np\nimport jax\nimport jax.numpy as jnp\nimport matplotlib.pyplot as plt\nfrom jax import jit, vmap\nfrom dataclasses import dataclass\nfrom diffrax import ODETerm, Dopri5, SaveAt, PIDController, diffeqsolve","key":"OobHYwgWCc"},{"type":"output","id":"Glf0Jg4sEX9-MlP6Iht5o","data":[],"key":"WEXx7jd5L7"}],"key":"ZYfh2ULXWM"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"mo-python"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Problème","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ja0t96mW8d"}],"identifier":"probl-me","label":"Problème","html_id":"probl-me","implicit":true,"key":"DDG3cnw7Eo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"On veut intégrer l’ODE suivante:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ro4c6NCP8V"}],"key":"MoG1mqwMVU"},{"type":"math","value":"\\left \\lbrace \n\\begin{split}\nM_1  \\ddot x_1 + D_1  \\dot x_1 + K_1  x_1 + K_{12} (x_1 - x_2) = F_{d1} \\sin (w_d t)  \\\\\nM_2  \\ddot x_2 + D_2  \\dot x_2 + K_2  x_1 + K_{12} (x_2 - x_1) = F_{d2} \\sin (w_d t) \n\\end{split}\n\\right .","position":{"start":{"line":6,"column":1},"end":{"line":13,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e{\u003c/mo\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e¨\u003c/mo\u003e\u003c/mover\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eD\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e˙\u003c/mo\u003e\u003c/mover\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eK\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eK\u003c/mi\u003e\u003cmn\u003e12\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003c/msub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e¨\u003c/mo\u003e\u003c/mover\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eD\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e˙\u003c/mo\u003e\u003c/mover\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eK\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eK\u003c/mi\u003e\u003cmn\u003e12\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003c/msub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\left \\lbrace \n\\begin{split}\nM_1  \\ddot x_1 + D_1  \\dot x_1 + K_1  x_1 + K_{12} (x_1 - x_2) = F_{d1} \\sin (w_d t)  \\\\\nM_2  \\ddot x_2 + D_2  \\dot x_2 + K_2  x_1 + K_{12} (x_2 - x_1) = F_{d2} \\sin (w_d t) \n\\end{split}\n\\right .\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size4\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.75em;\"\u003e\u003cspan style=\"top:-3.91em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6679em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2222em;\"\u003e\u003cspan class=\"mord\"\u003e¨\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6679em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.1111em;\"\u003e\u003cspan class=\"mord\"\u003e˙\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eK\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eK\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e12\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eF\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ed\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6679em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2222em;\"\u003e\u003cspan class=\"mord\"\u003e¨\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6679em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.1111em;\"\u003e\u003cspan class=\"mord\"\u003e˙\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eK\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eK\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e12\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eF\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ed\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.25em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"hxHzTcGymd"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"NiQeXM0BdW"}],"key":"YezYscw0Bz"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Il est possible de simplifier grandement cette équation en l’adimensionnant mais on fait le choix de ne pas le faire ici.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"dp3PwmsYfr"}],"key":"C6V6Vm0575"}],"key":"fvCCqXCcSv"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"On la traduit comme suit en Python:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KdaDnAE0Tz"}],"key":"qlaHml9fLn"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On crée une classe pour stocker les paramètres du problème:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"EYuhnPHCek"}],"key":"vFC9WcDHMU"}],"key":"yvY57tX7HR"}],"key":"ue8HqXW1kM"}],"key":"Wa9AoDuwDO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@dataclass\nclass CoupleLinearResonatorParams:\n    \"\"\"\n    Parameters for the coupled linear resonator ODE system.\n    \"\"\"\n\n    M1: float = 1.0  # Mass 1\n    M2: float = 1.0  # Mass 2\n    K1: float = 1.0  # Spring constant 1\n    K2: float = 1.0  # Spring constant 2\n    K12: float = 0.5  # Coupling spring constant 2\n    D1: float = 0.2  # Damping coefficient 1\n    D2: float = 0.2  # Damping coefficient 2\n    wd: float = 0.5  # Driving frequency\n    Fd1: float = 0.5  # Driving force amplitude 1\n    Fd2: float = 0.5  # Driving force amplitude 2\n\n\node_params = CoupleLinearResonatorParams(Fd2 = 0.)\node_params","key":"qKiIumz36T"},{"type":"output","id":"wAB7vO2TVhdRMMu0e9x6A","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"CoupleLinearResonatorParams(M1=1.0, M2=1.0, K1=1.0, K2=1.0, K12=0.5, D1=0.2, D2=0.2, wd=0.5, Fd1=0.5, Fd2=0.0)","content_type":"text/plain"}}}],"key":"T9rdjp0oUu"}],"key":"vkSbY6Cbef"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def coupled_linear_resonator_ode(t, X, params: CoupleLinearResonatorParams):\n    x1, v1, x2, v2 = X\n    dx1dt = v1\n    dv1dt = (\n        -params.K1 * x1\n        - params.K12 * (x1 - x2)\n        - params.D1 * v1\n        + params.Fd1 * jnp.sin(params.wd * t)\n    ) / params.M1\n    dx2dt = v2\n    dv2dt = (\n        -params.K2 * x2\n        - params.K12 * (x2 - x1)\n        - params.D2 * v2\n        + params.Fd2 * jnp.sin(params.wd * t)\n    ) / params.M2\n    return jnp.array([dx1dt, dv1dt, dx2dt, dv2dt])\n\n\node = coupled_linear_resonator_ode\nX = jnp.array([0.0, 0.0, 0.0, 0.0])  # Initial state: [x1, v1, x2, v2]\nt = 0.2  # Initial time\node(t,X,ode_params)","key":"UGa3QbaWz7"},{"type":"output","id":"_uEuiZl3S8b8rcbGaSmst","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"Array([0.        , 0.04991671, 0.        , 0.        ], dtype=float32)","content_type":"text/plain"}}}],"key":"p4DwGQDS7u"}],"key":"puDiK1p7bu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ok, ça marche !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hjfOZ7NWfs"}],"key":"qDv39Ny3jG"}],"key":"gocHFQiRwJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"term = ODETerm(ode)\nsolver = Dopri5()\nsaveat = SaveAt(ts=[0., 1., 2., 3.])\nstepsize_controller = PIDController(rtol=1e-5, atol=1e-5)\n\nsol = diffeqsolve(term, solver, t0=0, t1=3, dt0=0.1, y0=1, saveat=saveat,\n                   stepsize_controller=stepsize_controller)\n\n# print(sol.ts)  # DeviceArray([0.   , 1.   , 2.   , 3.    ])\n# print(sol.ys)  # DeviceArray([1.   , 0.368, 0.135, 0.0498])","key":"olVMN3QtLu"},{"type":"output","id":"BAwwZS6ObExNklRul39gt","data":[{"ename":"ValueError","evalue":"Terms are not compatible with solver! Got:\nODETerm(vector_field=\u003cfunction coupled_linear_resonator_ode\u003e)\nbut expected:\ndiffrax.AbstractTerm\nNote that terms are checked recursively: if you scroll up you may find a root-cause error that is more specific.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mTypeError\u001b[39m                                 Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:170\u001b[39m, in \u001b[36m_assert_term_compatible.\u003clocals\u003e._check\u001b[39m\u001b[34m(term_cls, term, term_contr_kwargs, yi)\u001b[39m\n\u001b[32m    169\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--\u003e \u001b[39m\u001b[32m170\u001b[39m     vf_type = \u001b[43meqx\u001b[49m\u001b[43m.\u001b[49m\u001b[43mfilter_eval_shape\u001b[49m\u001b[43m(\u001b[49m\u001b[43mterm\u001b[49m\u001b[43m.\u001b[49m\u001b[43mvf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mt\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43myi\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    171\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/equinox/_eval_shape.py:38\u001b[39m, in \u001b[36mfilter_eval_shape\u001b[39m\u001b[34m(fun, *args, **kwargs)\u001b[39m\n\u001b[32m     37\u001b[39m dynamic, static = partition((fun, args, kwargs), _filter)\n\u001b[32m---\u003e \u001b[39m\u001b[32m38\u001b[39m dynamic_out, static_out = \u001b[43mjax\u001b[49m\u001b[43m.\u001b[49m\u001b[43meval_shape\u001b[49m\u001b[43m(\u001b[49m\u001b[43mft\u001b[49m\u001b[43m.\u001b[49m\u001b[43mpartial\u001b[49m\u001b[43m(\u001b[49m\u001b[43m_fn\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mstatic\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdynamic\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     39\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m combine(dynamic_out, static_out.value)\n\n    \u001b[31m[... skipping hidden 1 frame]\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/api.py:3115\u001b[39m, in \u001b[36meval_shape\u001b[39m\u001b[34m(fun, *args, **kwargs)\u001b[39m\n\u001b[32m   3114\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m: fun = partial(fun)\n\u001b[32m-\u003e \u001b[39m\u001b[32m3115\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mjit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mtrace\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m.out_info\n\n    \u001b[31m[... skipping hidden 1 frame]\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:306\u001b[39m, in \u001b[36mjit_trace\u001b[39m\u001b[34m(jit_func, *args, **kwargs)\u001b[39m\n\u001b[32m    304\u001b[39m \u001b[38;5;129m@api_boundary\u001b[39m\n\u001b[32m    305\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mjit_trace\u001b[39m(jit_func, *args, **kwargs) -\u003e stages.Traced:\n\u001b[32m--\u003e \u001b[39m\u001b[32m306\u001b[39m   p, args_flat = \u001b[43m_infer_params\u001b[49m\u001b[43m(\u001b[49m\u001b[43mjit_func\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_fun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mjit_func\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_jit_info\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    307\u001b[39m   arg_types = \u001b[38;5;28mmap\u001b[39m(convert_to_metaty, args_flat)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:630\u001b[39m, in \u001b[36m_infer_params\u001b[39m\u001b[34m(fun, ji, args, kwargs)\u001b[39m\n\u001b[32m    629\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m--\u003e \u001b[39m\u001b[32m630\u001b[39m   \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_infer_params_internal\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mji\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:655\u001b[39m, in \u001b[36m_infer_params_internal\u001b[39m\u001b[34m(fun, ji, args, kwargs)\u001b[39m\n\u001b[32m    654\u001b[39m dbg = dbg_fn()\n\u001b[32m--\u003e \u001b[39m\u001b[32m655\u001b[39m p, args_flat = \u001b[43m_infer_params_impl\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    656\u001b[39m \u001b[43m    \u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mji\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mctx_mesh\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdbg\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43min_avals\u001b[49m\u001b[43m=\u001b[49m\u001b[43mavals\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    657\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m p.params[\u001b[33m'\u001b[39m\u001b[33mjaxpr\u001b[39m\u001b[33m'\u001b[39m].jaxpr.is_high:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:551\u001b[39m, in \u001b[36m_infer_params_impl\u001b[39m\u001b[34m(***failed resolving arguments***)\u001b[39m\n\u001b[32m    549\u001b[39m qdd_token = _qdd_cache_index(flat_fun, in_type)\n\u001b[32m--\u003e \u001b[39m\u001b[32m551\u001b[39m jaxpr, consts, out_avals = \u001b[43m_create_pjit_jaxpr\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    552\u001b[39m \u001b[43m    \u001b[49m\u001b[43mflat_fun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43min_type\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mqdd_token\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mIgnoreKey\u001b[49m\u001b[43m(\u001b[49m\u001b[43mji\u001b[49m\u001b[43m.\u001b[49m\u001b[43minline\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    553\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m config.mutable_array_checks.value:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:496\u001b[39m, in \u001b[36mcache.\u003clocals\u003e.memoized_fun\u001b[39m\u001b[34m(fun, *args)\u001b[39m\n\u001b[32m    495\u001b[39m   start = time.time()\n\u001b[32m--\u003e \u001b[39m\u001b[32m496\u001b[39m ans = \u001b[43mcall\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    497\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m do_explain:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/pjit.py:1184\u001b[39m, in \u001b[36m_create_pjit_jaxpr\u001b[39m\u001b[34m(***failed resolving arguments***)\u001b[39m\n\u001b[32m   1183\u001b[39m   \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m-\u003e \u001b[39m\u001b[32m1184\u001b[39m     jaxpr, global_out_avals, consts = \u001b[43mpe\u001b[49m\u001b[43m.\u001b[49m\u001b[43mtrace_to_jaxpr_dynamic\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43min_type\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1186\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m config.debug_key_reuse.value:\n\u001b[32m   1187\u001b[39m   \u001b[38;5;66;03m# Import here to avoid circular imports\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/profiler.py:359\u001b[39m, in \u001b[36mannotate_function.\u003clocals\u003e.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    358\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m TraceAnnotation(name, **decorator_kwargs):\n\u001b[32m--\u003e \u001b[39m\u001b[32m359\u001b[39m   \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/interpreters/partial_eval.py:2409\u001b[39m, in \u001b[36mtrace_to_jaxpr_dynamic\u001b[39m\u001b[34m(fun, in_avals, keep_inputs, lower, auto_dce)\u001b[39m\n\u001b[32m   2408\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m core.set_current_trace(trace):\n\u001b[32m-\u003e \u001b[39m\u001b[32m2409\u001b[39m   ans = \u001b[43mfun\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcall_wrapped\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43min_tracers\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2410\u001b[39m _check_returned_jaxtypes(fun.debug_info, ans)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:212\u001b[39m, in \u001b[36mWrappedFun.call_wrapped\u001b[39m\u001b[34m(self, *args, **kwargs)\u001b[39m\n\u001b[32m    211\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"Calls the transformed function\"\"\"\u001b[39;00m\n\u001b[32m--\u003e \u001b[39m\u001b[32m212\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mf_transformed\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/api_util.py:73\u001b[39m, in \u001b[36mflatten_fun\u001b[39m\u001b[34m(f, store, in_tree, *args_flat)\u001b[39m\n\u001b[32m     72\u001b[39m py_args, py_kwargs = tree_unflatten(in_tree, args_flat)\n\u001b[32m---\u003e \u001b[39m\u001b[32m73\u001b[39m ans = \u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43mpy_args\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mpy_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     74\u001b[39m ans, out_tree = tree_flatten(ans)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/linear_util.py:421\u001b[39m, in \u001b[36m_get_result_paths_thunk\u001b[39m\u001b[34m(_fun, _store, *args, **kwargs)\u001b[39m\n\u001b[32m    419\u001b[39m \u001b[38;5;129m@transformation_with_aux2\u001b[39m\n\u001b[32m    420\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_get_result_paths_thunk\u001b[39m(_fun: Callable, _store: Store, *args, **kwargs):\n\u001b[32m--\u003e \u001b[39m\u001b[32m421\u001b[39m   ans = \u001b[43m_fun\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    422\u001b[39m   result_paths = \u001b[38;5;28mtuple\u001b[39m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mresult\u001b[39m\u001b[38;5;132;01m{\u001b[39;00m_clean_keystr_arg_names(path)\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m\"\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m path, _ \u001b[38;5;129;01min\u001b[39;00m generate_key_paths(ans))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/equinox/_eval_shape.py:33\u001b[39m, in \u001b[36mfilter_eval_shape.\u003clocals\u003e._fn\u001b[39m\u001b[34m(_static, _dynamic)\u001b[39m\n\u001b[32m     32\u001b[39m _fun, _args, _kwargs = combine(_static, _dynamic)\n\u001b[32m---\u003e \u001b[39m\u001b[32m33\u001b[39m _out = \u001b[43m_fun\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43m_args\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     34\u001b[39m _dynamic_out, _static_out = partition(_out, _filter)\n\n    \u001b[31m[... skipping hidden 1 frame]\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_term.py:194\u001b[39m, in \u001b[36mODETerm.vf\u001b[39m\u001b[34m(self, t, y, args)\u001b[39m\n\u001b[32m    193\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mvf\u001b[39m(\u001b[38;5;28mself\u001b[39m, t: RealScalarLike, y: Y, args: Args) -\u003e _VF:\n\u001b[32m--\u003e \u001b[39m\u001b[32m194\u001b[39m     out = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mvector_field\u001b[49m\u001b[43m(\u001b[49m\u001b[43mt\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    195\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m jtu.tree_structure(out) != jtu.tree_structure(y):\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[3]\u001b[39m\u001b[32m, line 2\u001b[39m, in \u001b[36mcoupled_linear_resonator_ode\u001b[39m\u001b[34m(t, X, params)\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mcoupled_linear_resonator_ode\u001b[39m(t, X, params: CoupleLinearResonatorParams):\n\u001b[32m----\u003e \u001b[39m\u001b[32m2\u001b[39m     x1, v1, x2, v2 = X\n\u001b[32m      3\u001b[39m     dx1dt = v1\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/core.py:944\u001b[39m, in \u001b[36mTracer.__iter__\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    943\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m__iter__\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m--\u003e \u001b[39m\u001b[32m944\u001b[39m   \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28miter\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43maval\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_iter\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m)\u001b[49m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/lax/lax.py:3913\u001b[39m, in \u001b[36m_iter\u001b[39m\u001b[34m(tracer)\u001b[39m\n\u001b[32m   3912\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m tracer.ndim == \u001b[32m0\u001b[39m:\n\u001b[32m-\u003e \u001b[39m\u001b[32m3913\u001b[39m   \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[33m\"\u001b[39m\u001b[33miteration over a 0-d array\u001b[39m\u001b[33m\"\u001b[39m)  \u001b[38;5;66;03m# same as numpy error\u001b[39;00m\n\u001b[32m   3914\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mTypeError\u001b[39m: iteration over a 0-d array\n\nDuring handling of the above exception, another exception occurred:\n\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:200\u001b[39m, in \u001b[36m_assert_term_compatible\u001b[39m\u001b[34m(t, y, args, terms, term_structure, contr_kwargs)\u001b[39m\n\u001b[32m    199\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m jax.numpy_dtype_promotion(\u001b[33m\"\u001b[39m\u001b[33mstandard\u001b[39m\u001b[33m\"\u001b[39m):\n\u001b[32m--\u003e \u001b[39m\u001b[32m200\u001b[39m         \u001b[43mjtu\u001b[49m\u001b[43m.\u001b[49m\u001b[43mtree_map\u001b[49m\u001b[43m(\u001b[49m\u001b[43m_check\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mterm_structure\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mterms\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcontr_kwargs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    201\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m    202\u001b[39m     \u001b[38;5;66;03m# ValueError may also arise from mismatched tree structures\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/tree_util.py:361\u001b[39m, in \u001b[36mtree_map\u001b[39m\u001b[34m(f, tree, is_leaf, *rest)\u001b[39m\n\u001b[32m    360\u001b[39m all_leaves = [leaves] + [treedef.flatten_up_to(r) \u001b[38;5;28;01mfor\u001b[39;00m r \u001b[38;5;129;01min\u001b[39;00m rest]\n\u001b[32m--\u003e \u001b[39m\u001b[32m361\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mtreedef\u001b[49m\u001b[43m.\u001b[49m\u001b[43munflatten\u001b[49m\u001b[43m(\u001b[49m\u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43mxs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mxs\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43mzip\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43mall_leaves\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/jax/_src/tree_util.py:361\u001b[39m, in \u001b[36m\u003cgenexpr\u003e\u001b[39m\u001b[34m(.0)\u001b[39m\n\u001b[32m    360\u001b[39m all_leaves = [leaves] + [treedef.flatten_up_to(r) \u001b[38;5;28;01mfor\u001b[39;00m r \u001b[38;5;129;01min\u001b[39;00m rest]\n\u001b[32m--\u003e \u001b[39m\u001b[32m361\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m treedef.unflatten(\u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43mxs\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mfor\u001b[39;00m xs \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mzip\u001b[39m(*all_leaves))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:172\u001b[39m, in \u001b[36m_assert_term_compatible.\u003clocals\u003e._check\u001b[39m\u001b[34m(term_cls, term, term_contr_kwargs, yi)\u001b[39m\n\u001b[32m    171\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m--\u003e \u001b[39m\u001b[32m172\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mError while tracing \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mterm\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m.vf: \u001b[39m\u001b[33m\"\u001b[39m + \u001b[38;5;28mstr\u001b[39m(e))\n\u001b[32m    173\u001b[39m vf_type_compatible = eqx.filter_eval_shape(\n\u001b[32m    174\u001b[39m     better_isinstance, vf_type, vf_type_expected\n\u001b[32m    175\u001b[39m )\n\n\u001b[31mValueError\u001b[39m: Error while tracing ODETerm(vector_field=\u003cfunction coupled_linear_resonator_ode\u003e).vf: iteration over a 0-d array\n\nThe above exception was the direct cause of the following exception:\n\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[8]\u001b[39m\u001b[32m, line 6\u001b[39m\n\u001b[32m      3\u001b[39m saveat = SaveAt(ts=[\u001b[32m0.\u001b[39m, \u001b[32m1.\u001b[39m, \u001b[32m2.\u001b[39m, \u001b[32m3.\u001b[39m])\n\u001b[32m      4\u001b[39m stepsize_controller = PIDController(rtol=\u001b[32m1e-5\u001b[39m, atol=\u001b[32m1e-5\u001b[39m)\n\u001b[32m----\u003e \u001b[39m\u001b[32m6\u001b[39m sol = \u001b[43mdiffeqsolve\u001b[49m\u001b[43m(\u001b[49m\u001b[43mterm\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msolver\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mt0\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mt1\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m3\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdt0\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m0.1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my0\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msaveat\u001b[49m\u001b[43m=\u001b[49m\u001b[43msaveat\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m      7\u001b[39m \u001b[43m                   \u001b[49m\u001b[43mstepsize_controller\u001b[49m\u001b[43m=\u001b[49m\u001b[43mstepsize_controller\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m      9\u001b[39m \u001b[38;5;66;03m# print(sol.ts)  # DeviceArray([0.   , 1.   , 2.   , 3.    ])\u001b[39;00m\n\u001b[32m     10\u001b[39m \u001b[38;5;66;03m# print(sol.ys)  # DeviceArray([1.   , 0.368, 0.135, 0.0498])\u001b[39;00m\n\n    \u001b[31m[... skipping hidden 18 frame]\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:1103\u001b[39m, in \u001b[36mdiffeqsolve\u001b[39m\u001b[34m(terms, solver, t0, t1, dt0, y0, args, saveat, stepsize_controller, adjoint, event, max_steps, throw, progress_meter, solver_state, controller_state, made_jump, discrete_terminating_event)\u001b[39m\n\u001b[32m   1100\u001b[39m         terms = MultiTerm(*terms)\n\u001b[32m   1102\u001b[39m \u001b[38;5;66;03m# Error checking for term compatibility\u001b[39;00m\n\u001b[32m-\u003e \u001b[39m\u001b[32m1103\u001b[39m \u001b[43m_assert_term_compatible\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1104\u001b[39m \u001b[43m    \u001b[49m\u001b[43mt0\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1105\u001b[39m \u001b[43m    \u001b[49m\u001b[43my0\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1106\u001b[39m \u001b[43m    \u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1107\u001b[39m \u001b[43m    \u001b[49m\u001b[43mterms\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1108\u001b[39m \u001b[43m    \u001b[49m\u001b[43msolver\u001b[49m\u001b[43m.\u001b[49m\u001b[43mterm_structure\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1109\u001b[39m \u001b[43m    \u001b[49m\u001b[43msolver\u001b[49m\u001b[43m.\u001b[49m\u001b[43mterm_compatible_contr_kwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1110\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1112\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m is_sde(terms):\n\u001b[32m   1113\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(solver, (AbstractItoSolver, AbstractStratonovichSolver)):\n\n\u001b[36mFile \u001b[39m\u001b[32m~/miniforge3/envs/science/lib/python3.12/site-packages/diffrax/_integrate.py:205\u001b[39m, in \u001b[36m_assert_term_compatible\u001b[39m\u001b[34m(t, y, args, terms, term_structure, contr_kwargs)\u001b[39m\n\u001b[32m    203\u001b[39m pretty_term = wl.pformat(terms)\n\u001b[32m    204\u001b[39m pretty_expected = wl.pformat(term_structure)\n\u001b[32m--\u003e \u001b[39m\u001b[32m205\u001b[39m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    206\u001b[39m     \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mTerms are not compatible with solver! Got:\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;132;01m{\u001b[39;00mpretty_term\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mbut expected:\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    207\u001b[39m     \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;132;01m{\u001b[39;00mpretty_expected\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33mNote that terms are checked recursively: if you \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    208\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mscroll up you may find a root-cause error that is more specific.\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    209\u001b[39m ) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01me\u001b[39;00m\n\n\u001b[31mValueError\u001b[39m: Terms are not compatible with solver! Got:\nODETerm(vector_field=\u003cfunction coupled_linear_resonator_ode\u003e)\nbut expected:\ndiffrax.AbstractTerm\nNote that terms are checked recursively: if you scroll up you may find a root-cause error that is more specific."}],"key":"ed1aioenZo"}],"key":"BPGYmASPWg"}],"key":"rArf66nae5"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"JAX pour Cloé","url":"/","group":"JAX pour Cloé"}}},"domain":"http://localhost:3003"},"project":{"title":"JAX pour Cloé","github":"https://github.com/lcharleux/hello_jax","id":"8d100ed7-36b2-4354-97ab-43bab996214f","thumbnail":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.gif","thumbnailOptimized":"lcharleux.github.io/hello_jax//build/96a8e99706627d5058e08d07f71549be.webp","exports":[],"bibliography":[],"index":"intro-to-jax","pages":[{"slug":"ode-with-jax","title":"Des ODE avec Jax ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "lcharleux.github.io/hello_jax//build/manifest-51D9907C.js";
import * as route0 from "lcharleux.github.io/hello_jax//build/root-TRTRBUUN.js";
import * as route1 from "lcharleux.github.io/hello_jax//build/routes/$-VLPGWU3Z.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("lcharleux.github.io/hello_jax//build/entry.client-PCJPW7TK.js");</script></body></html>